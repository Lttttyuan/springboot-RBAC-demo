"use strict";(self["webpackChunkspringboot_vue_view"]=self["webpackChunkspringboot_vue_view"]||[]).push([[844],{9844:function(e,l,a){a.r(l),a.d(l,{default:function(){return g}});var t=a(3396);const i={style:{padding:"10px"}},o={style:{margin:"10px 0"}},s={style:{margin:"10px 0",width:"20%",display:"flex"}},r={class:"demo-pagination-block",style:{margin:"8px 0"}},d=(0,t._)("div",{class:"el-upload__tip"}," 只能上传jpg/png文件,且不能超过500kb. ",-1),n={class:"dialog-footer"};function m(e,l,a,m,u,p){const h=(0,t.up)("el-button"),c=(0,t.up)("el-popconfirm"),g=(0,t.up)("el-input"),f=(0,t.up)("el-table-column"),b=(0,t.up)("el-image"),w=(0,t.up)("el-table"),k=(0,t.up)("el-pagination"),W=(0,t.up)("el-form-item"),y=(0,t.up)("el-date-picker"),_=(0,t.up)("el-upload"),C=(0,t.up)("el-form"),V=(0,t.up)("el-dialog");return(0,t.wg)(),(0,t.iD)("div",i,[(0,t._)("div",o,[1==u.user.role?((0,t.wg)(),(0,t.j4)(h,{key:0,type:"primary",onClick:p.add},{default:(0,t.w5)((()=>[(0,t.Uk)("新增")])),_:1},8,["onClick"])):(0,t.kq)("",!0),1===u.user.role?((0,t.wg)(),(0,t.j4)(c,{key:1,title:"确定删除吗？",onConfirm:p.deleteBatch},{reference:(0,t.w5)((()=>[(0,t.Wm)(h,{type:"danger"},{default:(0,t.w5)((()=>[(0,t.Uk)("批量删除")])),_:1})])),_:1},8,["onConfirm"])):(0,t.kq)("",!0)]),(0,t._)("div",s,[(0,t.Wm)(g,{modelValue:u.search,"onUpdate:modelValue":l[0]||(l[0]=e=>u.search=e),placeholder:"请输入书籍名称进行查询",clearable:""},null,8,["modelValue"]),(0,t.Wm)(h,{style:{"margin-left":"5px"},type:"primary",onClick:p.findPage},{default:(0,t.w5)((()=>[(0,t.Uk)("查询")])),_:1},8,["onClick"])]),(0,t.Wm)(w,{data:u.tableData,border:"",stripe:"",style:{width:"auto"},onSelectionChange:p.handleSelectionChange},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{type:"selection",width:"55"}),(0,t.Wm)(f,{prop:"id",label:"id",sortable:""}),(0,t.Wm)(f,{prop:"name",label:"书籍名称"}),(0,t.Wm)(f,{label:"封面"},{default:(0,t.w5)((e=>[(0,t.Wm)(b,{style:{width:"100px",height:"100px"},src:e.row.cover,"zoom-rate":1.2,"preview-src-list":[e.row.cover],"initial-index":4,"preview-teleported":"true",fit:"cover"},null,8,["src","preview-src-list"])])),_:1}),(0,t.Wm)(f,{prop:"price",label:"价格"}),(0,t.Wm)(f,{prop:"author",label:"年龄"}),(0,t.Wm)(f,{prop:"createTime",label:"出版时间"}),1==u.user.role?((0,t.wg)(),(0,t.j4)(f,{key:0,label:"操作"},{default:(0,t.w5)((l=>[(0,t.Wm)(h,{size:"small",onClick:e=>p.handleEdit(l.row)},{default:(0,t.w5)((()=>[(0,t.Uk)("编辑")])),_:2},1032,["onClick"]),(0,t.Wm)(c,{width:"220","confirm-button-text":"确认","cancel-button-text":"取消",icon:e.InfoFilled,"icon-color":"#626AEF",title:"确认要删除吗？",onConfirm:e=>p.handleDelete(l.row.id)},{reference:(0,t.w5)((()=>[(0,t.Wm)(h,{size:"small",type:"danger"},{default:(0,t.w5)((()=>[(0,t.Uk)("删除")])),_:1})])),_:2},1032,["icon","onConfirm"])])),_:1})):(0,t.kq)("",!0)])),_:1},8,["data","onSelectionChange"]),(0,t._)("div",r,[(0,t.Wm)(k,{"current-page":u.currentPage,"onUpdate:currentPage":l[1]||(l[1]=e=>u.currentPage=e),"page-size":u.pageSize,"onUpdate:pageSize":l[2]||(l[2]=e=>u.pageSize=e),"page-sizes":[5,10,20],small:!0,disabled:!1,background:!0,layout:"total, sizes, prev, pager, next, jumper",total:u.total,onSizeChange:p.handleSizeChange,onCurrentChange:p.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])]),(0,t.Wm)(V,{modelValue:u.dialogVisible,"onUpdate:modelValue":l[8]||(l[8]=e=>u.dialogVisible=e),"lock-scroll":!1,"append-to-body":!0,title:"编辑",width:"30%"},{footer:(0,t.w5)((()=>[(0,t._)("span",n,[(0,t.Wm)(h,{onClick:l[7]||(l[7]=e=>u.dialogVisible=!1)},{default:(0,t.w5)((()=>[(0,t.Uk)("取消")])),_:1}),(0,t.Wm)(h,{type:"primary",onClick:p.save},{default:(0,t.w5)((()=>[(0,t.Uk)("确认")])),_:1},8,["onClick"])])])),default:(0,t.w5)((()=>[(0,t.Wm)(C,{model:u.form},{default:(0,t.w5)((()=>[(0,t.Wm)(W,{label:"书籍名称：","label-width":u.formLabelWidth},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{modelValue:u.form.name,"onUpdate:modelValue":l[3]||(l[3]=e=>u.form.name=e),style:{width:"80%"}},null,8,["modelValue"])])),_:1},8,["label-width"]),(0,t.Wm)(W,{label:"价格：","label-width":u.formLabelWidth},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{modelValue:u.form.price,"onUpdate:modelValue":l[4]||(l[4]=e=>u.form.price=e),style:{width:"80%"}},null,8,["modelValue"])])),_:1},8,["label-width"]),(0,t.Wm)(W,{label:"作者：","label-width":u.formLabelWidth},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{modelValue:u.form.author,"onUpdate:modelValue":l[5]||(l[5]=e=>u.form.author=e),style:{width:"80%"},placeholder:"默认为：author"},null,8,["modelValue"])])),_:1},8,["label-width"]),(0,t.Wm)(W,{label:"出版时间：","label-width":u.formLabelWidth},{default:(0,t.w5)((()=>[(0,t.Wm)(y,{modelValue:u.form.createTime,"onUpdate:modelValue":l[6]||(l[6]=e=>u.form.createTime=e),"value-format":"YYYY-MM-DD",type:"date",clearable:""},null,8,["modelValue"])])),_:1},8,["label-width"]),(0,t.Wm)(W,{label:"封面：","label-width":u.formLabelWidth},{default:(0,t.w5)((()=>[(0,t.Wm)(_,{limit:"1",action:u.filesUploadUrl,ref:"upload","on-success":e.fileUploadSuccess},{tip:(0,t.w5)((()=>[d])),default:(0,t.w5)((()=>[(0,t.Wm)(h,{type:"primary"},{default:(0,t.w5)((()=>[(0,t.Uk)("点击上传")])),_:1})])),_:1},8,["action","on-success"])])),_:1},8,["label-width"])])),_:1},8,["model"])])),_:1},8,["modelValue"])])}var u=a(60),p={name:"Book",components:{},data(){return{user:{},form:{},formLabelWidth:120,dialogVisible:!1,currentPage:1,pageSize:10,total:0,search:"",tableData:[],filesUploadUrl:"http://"+window.server.filesUploadUrl+":8081/files/upload",ids:[]}},created(){this.findPage();let e=sessionStorage.getItem("userInfo")||"{}";this.user=JSON.parse(e),u.Z.get("/user/findId/"+this.user.id).then((e=>{"0"===e.code&&(this.user=e.data)}))},methods:{deleteBatch(){this.ids.length?u.Z.post("/book/deleteBatch",this.ids).then((e=>{"0"===e.code?(this.$message.success("批量删除成功"),this.findPage()):this.$message.error(e.msg)})):this.$message.warning("请选择数据！")},handleSelectionChange(e){this.ids=e.map((e=>e.id))},findPage(){u.Z.get("/book/findPage",{params:{pageNum:this.currentPage,pageSize:this.pageSize,search:this.search}}).then((e=>{console.log(e),this.tableData=e.data.records,this.total=e.data.total}))},add(){this.dialogVisible=!0,this.form={},this.$nextTick((()=>{this.$refs.upload.clearFiles()}))},save(){this.form.id?u.Z.put("/book/updata",this.form).then((e=>{console.log(e),"0"==e.code?this.$message({type:"success",message:"更新成功"}):this.errorInfo(e)})):u.Z.post("/book/save",this.form).then((e=>{console.log(e),"0"==e.code?this.$message({type:"success",message:"更新成功"}):this.$message({type:"success",message:"更新失败"})})),this.findPage(),this.dialogVisible=!1},handleEdit(e){this.form=JSON.parse(JSON.stringify(e)),this.dialogVisible=!0,this.$nextTick((()=>{this.$refs.upload.clearFiles()}))},errorInfo(e){this.$message({type:"error",message:e.msg})},handleDelete(e){console.log(e),u.Z.delete("/book/delete/"+e).then((e=>{"0"==e.code?this.$message({type:"success",message:"删除成功"}):this.errorInfo(e),this.findPage()}))},handleSizeChange(e){this.pageSize=e,this.findPage()},handleCurrentChange(e){this.currentPage=e,this.findPage()}}},h=a(89);const c=(0,h.Z)(p,[["render",m]]);var g=c}}]);
//# sourceMappingURL=844.38859c0c.js.map