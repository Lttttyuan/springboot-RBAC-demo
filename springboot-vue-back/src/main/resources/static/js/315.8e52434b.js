"use strict";(self["webpackChunkspringboot_vue_view"]=self["webpackChunkspringboot_vue_view"]||[]).push([[315],{533:function(e,l,a){a.r(l),a.d(l,{default:function(){return h}});var o=a(3396);const t={style:{padding:"10px"}},i={style:{margin:"10px 0"}},s={style:{margin:"10px 0"}},r={style:{margin:"10px 0"}},n={class:"dialog-footer"};function d(e,l,a,d,m,p){const u=(0,o.up)("el-button"),g=(0,o.up)("el-input"),h=(0,o.up)("el-table-column"),c=(0,o.up)("el-option"),f=(0,o.up)("el-select"),w=(0,o.up)("el-form-item"),b=(0,o.up)("el-popconfirm"),C=(0,o.up)("el-table"),y=(0,o.up)("el-pagination"),k=(0,o.up)("el-form"),_=(0,o.up)("el-dialog"),V=(0,o.Q2)("loading");return(0,o.wg)(),(0,o.iD)("div",t,[(0,o._)("div",i,[(0,o.Wm)(u,{type:"primary",onClick:p.add},{default:(0,o.w5)((()=>[(0,o.Uk)("新增")])),_:1},8,["onClick"])]),(0,o._)("div",s,[(0,o.Wm)(g,{modelValue:m.search,"onUpdate:modelValue":l[0]||(l[0]=e=>m.search=e),placeholder:"请输入关键字",style:{width:"20%"},clearable:""},null,8,["modelValue"]),(0,o.Wm)(u,{type:"primary",style:{"margin-left":"5px"},onClick:p.load},{default:(0,o.w5)((()=>[(0,o.Uk)("查询")])),_:1},8,["onClick"])]),(0,o.wy)(((0,o.wg)(),(0,o.j4)(C,{data:m.tableData,border:"",stripe:"",style:{width:"100%"}},{default:(0,o.w5)((()=>[(0,o.Wm)(h,{prop:"rid",label:"id",sortable:"",width:"80"}),(0,o.Wm)(h,{prop:"roleName",label:"名称"}),(0,o.Wm)(h,{prop:"roleComment",label:"备注"}),(0,o.Wm)(h,{label:"权限菜单"},{default:(0,o.w5)((e=>[(0,o.Wm)(w,null,{default:(0,o.w5)((()=>[(0,o.Wm)(f,{clearable:"",modelValue:e.row.permissions,"onUpdate:modelValue":l=>e.row.permissions=l,multiple:"",placeholder:"请选择",style:{width:"80%"}},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(m.permissions,(e=>((0,o.wg)(),(0,o.j4)(c,{key:e.pid,label:e.permissionComment,value:e.pid},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:1}),(0,o.Wm)(h,{label:"操作"},{default:(0,o.w5)((e=>[(0,o.Wm)(u,{size:"mini",type:"primary",onClick:l=>p.changeRolePermission(e.row)},{default:(0,o.w5)((()=>[(0,o.Uk)("保存权限菜单")])),_:2},1032,["onClick"]),(0,o.Wm)(u,{size:"mini",onClick:l=>p.handleEdit(e.row)},{default:(0,o.w5)((()=>[(0,o.Uk)("编辑")])),_:2},1032,["onClick"]),(0,o.Wm)(b,{title:"确定删除吗？",onConfirm:l=>p.handleDelete(e.row.rid)},{reference:(0,o.w5)((()=>[(0,o.Wm)(u,{size:"mini",type:"danger"},{default:(0,o.w5)((()=>[(0,o.Uk)("删除")])),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"])),[[V,m.loading]]),(0,o._)("div",r,[(0,o.Wm)(y,{onSizeChange:p.handleSizeChange,onCurrentChange:p.handleCurrentChange,"current-page":m.currentPage,"page-sizes":[5,10,20],"page-size":m.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:m.total},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])]),(0,o.Wm)(_,{title:"提示",modelValue:m.dialogVisible,"onUpdate:modelValue":l[4]||(l[4]=e=>m.dialogVisible=e),width:"30%","lock-scroll":!1,"append-to-body":!0},{footer:(0,o.w5)((()=>[(0,o._)("span",n,[(0,o.Wm)(u,{onClick:l[3]||(l[3]=e=>m.dialogVisible=!1)},{default:(0,o.w5)((()=>[(0,o.Uk)("取 消")])),_:1}),(0,o.Wm)(u,{type:"primary",onClick:p.save},{default:(0,o.w5)((()=>[(0,o.Uk)("确 定")])),_:1},8,["onClick"])])])),default:(0,o.w5)((()=>[(0,o.Wm)(k,{model:m.form,"label-width":"120px"},{default:(0,o.w5)((()=>[(0,o.Wm)(w,{label:"名称"},{default:(0,o.w5)((()=>[(0,o.Wm)(g,{modelValue:m.form.roleName,"onUpdate:modelValue":l[1]||(l[1]=e=>m.form.roleName=e),style:{width:"80%"}},null,8,["modelValue"])])),_:1}),(0,o.Wm)(w,{label:"备注"},{default:(0,o.w5)((()=>[(0,o.Wm)(g,{modelValue:m.form.roleComment,"onUpdate:modelValue":l[2]||(l[2]=e=>m.form.roleComment=e),style:{width:"80%"}},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])])}a(7658);var m=a(60),p={name:"Role",components:{},data(){return{loading:!0,form:{},dialogVisible:!1,search:"",currentPage:1,pageSize:10,total:0,tableData:[],permissions:[]}},created(){this.load()},methods:{changeRolePermission(e){m.Z.put("/role/changePermission",e).then((l=>{if("0"===l.code){console.log(e.roleName),this.$message.success("更新权限成功");let l=JSON.parse(sessionStorage.getItem("userInfo"));console.log(l.role),-1!=l.role.search(e.roleName)&&this.$router.push("/login")}}))},load(){this.loading=!0,m.Z.get("/role/findPage",{params:{pageNum:this.currentPage,pageSize:this.pageSize,search:this.search}}).then((e=>{this.loading=!1,this.tableData=e.data.records,this.total=e.data.total,console.log(this.tableData)})),m.Z.get("/permission/all/").then((e=>{this.permissions=e.data}))},add(){this.dialogVisible=!0,this.form={}},save(){if(this.form.pid)m.Z.put("/role/updata",this.form).then((e=>{console.log(e),"0"===e.code?this.$message({type:"success",message:"更新成功"}):this.$message({type:"error",message:e.msg}),this.load(),this.dialogVisible=!1}));else{let e=sessionStorage.getItem("user")||"{}",l=JSON.parse(e);this.form.author=l.nickName,m.Z.post("/role/save",this.form).then((e=>{console.log(e),"0"===e.code?this.$message({type:"success",message:"新增成功"}):this.$message({type:"error",message:e.msg}),this.load(),this.dialogVisible=!1}))}},handleEdit(e){this.form=JSON.parse(JSON.stringify(e)),this.dialogVisible=!0},handleDelete(e){console.log(e),m.Z.delete("/role/delete/"+e).then((e=>{"0"===e.code?this.$message({type:"success",message:"删除成功"}):this.$message({type:"error",message:e.msg}),this.load()}))},handleSizeChange(e){this.pageSize=e,this.load()},handleCurrentChange(e){this.currentPage=e,this.load()}}},u=a(89);const g=(0,u.Z)(p,[["render",d]]);var h=g}}]);
//# sourceMappingURL=315.8e52434b.js.map