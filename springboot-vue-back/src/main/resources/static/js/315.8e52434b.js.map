{"version":3,"file":"js/315.8e52434b.js","mappings":"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","sources":["webpack://springboot-vue-view/./src/views/Role.vue","webpack://springboot-vue-view/./src/views/Role.vue?abc1"],"sourcesContent":["<template>\r\n  <div style=\"padding: 10px\">\r\n    <!--    功能区域-->\r\n    <div style=\"margin: 10px 0\">\r\n      <el-button type=\"primary\" @click=\"add\">新增</el-button>\r\n    </div>\r\n\r\n    <!--    搜索区域-->\r\n    <div style=\"margin: 10px 0\">\r\n      <el-input v-model=\"search\" placeholder=\"请输入关键字\" style=\"width: 20%\" clearable></el-input>\r\n      <el-button type=\"primary\" style=\"margin-left: 5px\" @click=\"load\">查询</el-button>\r\n    </div>\r\n    <el-table\r\n        v-loading=\"loading\"\r\n        :data=\"tableData\"\r\n        border\r\n        stripe\r\n        style=\"width: 100%\">\r\n      <el-table-column prop=\"rid\" label=\"id\" sortable width=\"80\"></el-table-column>\r\n      <el-table-column prop=\"roleName\" label=\"名称\"></el-table-column>\r\n      <el-table-column prop=\"roleComment\" label=\"备注\"></el-table-column>\r\n      <el-table-column label=\"权限菜单\">\r\n        <template #default=\"scope\">\r\n          <el-form-item>\r\n            <el-select clearable v-model=\"scope.row.permissions\" multiple placeholder=\"请选择\" style=\"width: 80%\">\r\n              <el-option v-for=\"item in permissions\" :key=\"item.pid\" :label=\"item.permissionComment\" :value=\"item.pid\"></el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"操作\">\r\n        <template #default=\"scope\">\r\n          <el-button size=\"mini\" type=\"primary\" @click=\"changeRolePermission(scope.row)\">保存权限菜单</el-button>\r\n          <el-button size=\"mini\" @click=\"handleEdit(scope.row)\">编辑</el-button>\r\n          <el-popconfirm title=\"确定删除吗？\" @confirm=\"handleDelete(scope.row.rid)\">\r\n            <template #reference>\r\n              <el-button size=\"mini\" type=\"danger\">删除</el-button>\r\n            </template>\r\n          </el-popconfirm>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <div style=\"margin: 10px 0\">\r\n      <el-pagination\r\n          @size-change=\"handleSizeChange\"\r\n          @current-change=\"handleCurrentChange\"\r\n          :current-page=\"currentPage\"\r\n          :page-sizes=\"[5, 10, 20]\"\r\n          :page-size=\"pageSize\"\r\n          layout=\"total, sizes, prev, pager, next, jumper\"\r\n          :total=\"total\">\r\n      </el-pagination>\r\n    </div>\r\n\r\n    <el-dialog title=\"提示\" v-model=\"dialogVisible\" width=\"30%\" :lock-scroll=\"false\" :append-to-body=\"true\">\r\n      <el-form :model=\"form\" label-width=\"120px\">\r\n        <el-form-item label=\"名称\">\r\n          <el-input v-model=\"form.roleName\" style=\"width: 80%\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"备注\">\r\n          <el-input v-model=\"form.roleComment\" style=\"width: 80%\"></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n          <span class=\"dialog-footer\">\r\n            <el-button @click=\"dialogVisible = false\">取 消</el-button>\r\n            <el-button type=\"primary\" @click=\"save\">确 定</el-button>\r\n          </span>\r\n      </template>\r\n    </el-dialog>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n\r\nimport request from \"@/utils/request\";\r\n\r\nexport default {\r\n  name: 'Role',\r\n  components: {},\r\n  data() {\r\n    return {\r\n      loading: true,\r\n      form: {},\r\n      dialogVisible: false,\r\n      search: '',\r\n      currentPage: 1,\r\n      pageSize: 10,\r\n      total: 0,\r\n      tableData: [],\r\n      permissions: []\r\n    }\r\n  },\r\n  created() {\r\n    this.load()\r\n  },\r\n  methods: {\r\n    changeRolePermission(row){\r\n      request.put(\"/role/changePermission\",row).then((res) =>{\r\n        if (res.code === '0'){\r\n          console.log(row.roleName)\r\n          this.$message.success(\"更新权限成功\")\r\n          //当前登录的用户id如果等于当前操作行的角色id，那么就需要重新登陆\r\n          let user = JSON.parse(sessionStorage.getItem(\"userInfo\"))\r\n          console.log(user.role)\r\n          // 注意：!=-1即为为真，可以找到得情况\r\n          if (user.role.search(row.roleName) != -1){\r\n            this.$router.push('/login')\r\n          }\r\n        }\r\n      })\r\n    },\r\n    load() {\r\n      this.loading = true\r\n      request.get(\"/role/findPage\", {\r\n        params: {\r\n          pageNum: this.currentPage,\r\n          pageSize: this.pageSize,\r\n          search: this.search\r\n        }\r\n      }).then(res => {\r\n        this.loading = false\r\n        this.tableData = res.data.records\r\n        this.total = res.data.total\r\n        console.log(this.tableData)\r\n      })\r\n\r\n      request.get(\"/permission/all/\").then(res => {\r\n        this.permissions = res.data\r\n      })\r\n    },\r\n    add() {\r\n      this.dialogVisible = true\r\n      this.form = {}\r\n    },\r\n    save() {\r\n      if (this.form.pid) {  // 更新\r\n        request.put(\"/role/updata\", this.form).then(res => {\r\n          console.log(res)\r\n          if (res.code === '0') {\r\n            this.$message({\r\n              type: \"success\",\r\n              message: \"更新成功\"\r\n            })\r\n          } else {\r\n            this.$message({\r\n              type: \"error\",\r\n              message: res.msg\r\n            })\r\n          }\r\n          this.load() // 刷新表格的数据\r\n          this.dialogVisible = false  // 关闭弹窗\r\n        })\r\n      } else {  // 新增\r\n        let userStr = sessionStorage.getItem(\"user\") || \"{}\"\r\n        let user = JSON.parse(userStr)\r\n        this.form.author = user.nickName\r\n\r\n        request.post(\"/role/save\", this.form).then(res => {\r\n          console.log(res)\r\n          if (res.code === '0') {\r\n            this.$message({\r\n              type: \"success\",\r\n              message: \"新增成功\"\r\n            })\r\n          } else {\r\n            this.$message({\r\n              type: \"error\",\r\n              message: res.msg\r\n            })\r\n          }\r\n\r\n          this.load() // 刷新表格的数据\r\n          this.dialogVisible = false  // 关闭弹窗\r\n        })\r\n      }\r\n\r\n    },\r\n    handleEdit(row) {\r\n      this.form = JSON.parse(JSON.stringify(row))\r\n      this.dialogVisible = true\r\n    },\r\n    handleDelete(rid) {\r\n      console.log(rid)\r\n      request.delete(\"/role/delete/\" + rid).then(res => {\r\n        if (res.code === '0') {\r\n          this.$message({\r\n            type: \"success\",\r\n            message: \"删除成功\"\r\n          })\r\n        } else {\r\n          this.$message({\r\n            type: \"error\",\r\n            message: res.msg\r\n          })\r\n        }\r\n        this.load()  // 删除之后重新加载表格的数据\r\n      })\r\n    },\r\n    handleSizeChange(pageSize) {   // 改变当前每页的个数触发\r\n      this.pageSize = pageSize\r\n      this.load()\r\n    },\r\n    handleCurrentChange(pageNum) {  // 改变当前页码触发\r\n      this.currentPage = pageNum\r\n      this.load()\r\n    }\r\n  }\r\n}\r\n</script>\r\n","import { render } from \"./Role.vue?vue&type=template&id=e9c984fc\"\nimport script from \"./Role.vue?vue&type=script&lang=js\"\nexport * from \"./Role.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["style","class","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_createVNode","_component_el_button","type","onClick","$options","add","_hoisted_3","_component_el_input","$data","search","$event","placeholder","clearable","load","_createBlock","_component_el_table","data","tableData","border","stripe","_component_el_table_column","prop","label","sortable","width","default","_withCtx","scope","_component_el_form_item","_component_el_select","row","permissions","multiple","_Fragment","_renderList","item","_component_el_option","key","pid","permissionComment","value","size","changeRolePermission","handleEdit","_component_el_popconfirm","title","onConfirm","handleDelete","rid","reference","loading","_hoisted_4","_component_el_pagination","onSizeChange","handleSizeChange","onCurrentChange","handleCurrentChange","currentPage","pageSize","layout","total","_component_el_dialog","dialogVisible","footer","_hoisted_5","_cache","save","_component_el_form","model","form","roleName","roleComment","name","components","created","this","methods","request","put","then","res","code","console","log","$message","success","user","JSON","parse","sessionStorage","getItem","role","$router","push","get","params","pageNum","records","message","msg","userStr","author","nickName","post","stringify","delete","__exports__","render"],"sourceRoot":""}